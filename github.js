var data=[[1,3235657,.8863901673398131],[2,1738577,.9389553830839147],[3,1167374,.9590113646805415],[4,874405,.969298041873032],[5,700175,.9754155756982751],[6,582479,.9795480974287222],[7,497477,.9825326730483819],[8,432315,.9848206299967862],[9,381753,.9865959542536418],[10,340571,.9880419295620912],[11,306440,.9892403313699852],[13,253733,.9910909704983046],[16,200154,.9929722271408041],[19,163558,.9942571796051822],[21,145252,.9948999367319968],[26,112533,.9960487606384889],[31,90998,.9968048938585234],[36,75525,.9973481791760805],[41,64392,.9977390791593006],[46,55968,.9980348611999587],[51,49278,.9982697593305382],[61,39521,.9986123454381712],[71,32894,.998845031523575],[81,28087,.9990138140816759],[91,24412,.9991428500502678],[101,21547,.9992434454380272],[111,19251,.9993240621955475],[131,15664,.9994500083232589],[151,13061,.999541404412033],[181,10373,.999635785006203],[201,9110,.9996801312452048],[251,6928,.9997567452543117],[301,5526,.9998059720374316],[351,4379,.9998462453043635],[401,3861,.9998644332313651],[451,3330,.999883077612133],[501,2896,.9998983161455668],[601,2309,.9999189267887133],[651,2063,.9999275642984475],[701,1873,.9999342355458034],[751,1700,.9999403098920799],[801,1547,.9999456820017928],[851,1427,.9999498954211753],[901,1327,.9999534066039941],[951,1241,.9999564262212184],[1001,1154,.9999594809502708],[1101,1018,.9999642561589044],[1201,912,.9999679780126923],[1301,833,.9999707518471191],[1401,762,.9999732447869205],[1501,704,.9999752812729554],[1601,650,.9999771773116776],[1701,598,.9999790031267434],[1801,553,.9999805831590118],[1901,515,.9999819174084831],[2001,481,.9999831112106414],[2101,456,.9999839890063461],[2201,413,.9999854988149582],[2301,385,.9999864819461475],[2401,360,.9999873597418523],[2501,339,.9999880970902442],[2801,285,.9999899931289663],[3001,253,.9999911167074683],[3201,233,.9999918189440321],[3501,203,.9999928722988778],[3801,185,.9999935043117851],[4001,168,.9999941012128644],[4201,158,.9999944523311463],[4501,147,.9999948385612564],[4801,127,.99999554079782],[5001,117,.9999958919161019],[5501,109,.9999961728107275],[6001,95,.9999966643763221],[6501,83,.9999970857182604],[7001,76,.9999973315010577],[7501,68,.9999976123956832],[8001,63,.9999977879548242],[8501,60,.9999978932903087],[9001,56,.9999980337376214],[9501,50,.9999982444085905],[10001,45,.9999984199677315],[10501,42,.9999985253032161],[11001,39,.9999986306387006],[11501,33,.9999988413096698],[12001,29,.9999989817569825],[12501,26,.9999990870924671],[13001,26,.9999990870924671],[13698,25,.9999991222042953],[14022,22,.9999992275397799],[15064,20,.9999992977634362],[15400,18,.9999993679870927],[16718,15,.9999994733225772],[17001,14,.9999995084344053],[18882,13,.9999995435462335],[19668,12,.9999995786580618],[20014,11,.9999996137698899],[20814,10,.9999996488817181],[22754,9,.9999996839935463],[25428,8,.9999997191053744],[27732,6,.9999997893290309],[33818,4,.9999998595526872],[36980,3,.9999998946645154],[44150,2,.9999999297763437],[68793,1,.9999999648881718]],div=d3.select("#followers_graph"),margin={top:10,right:60,bottom:30,left:60},width=div.nodes()[0].offsetWidth-margin.left-margin.right;height=div.nodes()[0].offsetWidth/2-margin.top-margin.bottom;var svg=div.append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")"),yLog=d3.scaleLog().domain([.15,1e-8]).range([height,0]),yLinear=d3.scaleLinear().domain([.12,0]).range([height,0]),xLog=d3.scaleLog().domain([1,1e5]).range([0,width]),xLinear=d3.scaleLinear().domain([1,7e4]).range([0,width]),x=xLog,y=yLog,xAxis=d3.axisBottom().ticks(5).tickFormat(function(t){return t.toLocaleString()}).scale(x);function formatRank(t){return(t>=.1?(100*t).toFixed(0):(100*t).toPrecision(1))+"%"}var yAxis=d3.axisLeft().ticks(6).tickFormat(formatRank).scale(y);svg.append("g").attr("class","x axis").attr("transform","translate(0,"+height+")").call(xAxis),svg.append("g").attr("class","y axis").call(yAxis),svg.append("text").attr("transform","rotate(-90)").attr("y",0-margin.left).attr("x",0-height/2).attr("dy","1em").style("font-weight","600").style("text-anchor","middle").text("Percentage Rank"),svg.append("text").attr("transform","translate("+width/2+" ,"+(height+margin.top+20)+")").style("text-anchor","middle").style("font-weight","600").text("# of Followers");var line=d3.line().x(function(t){return x(t[0])}).y(function(t){return y(1-t[2])});function setYScale(t){y=t,yAxis.scale(y),svg.select(".y.axis").transition().duration(750).call(yAxis),redraw()}function setXScale(t){x=t,xAxis.scale(x),svg.select(".x.axis").transition().duration(750).call(xAxis),redraw()}function redraw(){svg.select(".lines path").transition().duration(750).attr("d",line(data)),usersGroup.selectAll("circle").transition().duration(750).attr("cx",function(t){return x(t.followers)}).attr("cy",function(t){return y(1-rankScale.invert(t.followers))}),usersGroup.selectAll("text").transition().duration(750).attr("x",function(t){return x(t.followers)}).attr("y",function(t){return 15+y(1-rankScale.invert(t.followers))})}svg.append("g").attr("class","lines").append("path").style("fill","none").style("stroke",d3.schemeCategory10[0]).attr("d",line(data));var usersGroup=svg.append("g").attr("class","users"),users=[];function fetchUser(t){t=t.trim(),d3.selectAll("#githubuserid").attr("disabled","disabled"),d3.selectAll("#spinner").style("display","inline-block"),d3.selectAll("#github_search").text("Loading...").attr("disabled","disabled"),d3.selectAll("#gh_account_warning").style("display","None"),d3.json("https://api.github.com/users/"+t,function(e,a){if(d3.selectAll("#githubuserid").attr("disabled",null),d3.selectAll("#spinner").style("display","none"),d3.selectAll("#github_search").text("Search").attr("disabled",null),e)return html="<b>"+e.target.status+" error fetching userid '"+t+"'</b><p>"+e.target.response+"</p>",404==e.target.status&&(html="<b>Failed to find user "+t+"</b>! Try again with a valid GitHub userid. If you're stuck remembering a valid GitHub userid, try entering 'stitchpunk'"),d3.selectAll("#gh_account_info").style("display","None"),void d3.selectAll("#gh_account_warning").style("display","inline-block").html(html);console.log("user",a),addUser(t,a.followers,a)})}var indices=data.map(t=>t[0]),userScale=d3.scaleLog().range(indices).domain(data.map(t=>t[1])),rankScale=d3.scaleLog().range(indices).domain(data.map(t=>t[2]));function addUser(t,e,a){if(a){var n=a.name||a.login,r="{username} has <b>{followers}</b> followers on GitHub. Out of more than 28 million accounts on GitHub, {login} is approximately the <b>{ordinal}</b> most followed account. This puts {login} in the top <b>{rank}</b> of all accounts on GitHub";a.followers<=0&&(r="{username} has <b>{followers}</b> followers on GitHub. Of the over 28 million accounts on GitHub, 25 Million accounts also have 0 followers - putting {login} in good company."),"Organization"==a.type&&(r="{username} is an Organization, so doesn't have any followers. Try again with a user!");var l=Math.round(userScale.invert(a.followers)).toLocaleString(),i=l+({1:"st",2:"nd",3:"rd"}[l[l.length-1]]||"th");r=(r=r.split("{login}").join(a.login)).replace("{username}",n).replace("{followers}",a.followers.toLocaleString()).replace("{ordinal}",i).replace("{rank}",formatRank(1-rankScale.invert(a.followers))),d3.selectAll("#gh_account_info").style("display","inline-block"),d3.selectAll("#gh_account_img").attr("src",a.avatar_url),d3.selectAll("#gh_account_login").text(a.login),d3.selectAll("#gh_account_text").html(r)}users.some(e=>e.login==t)?console.log("already added user",t):e<=0||(users.push({login:t,followers:e}),(a=usersGroup.selectAll("g").data(users,function(t){return t.login}).enter().append("g").attr("id",t)).append("circle").attr("cx",function(t){return x(t.followers)}).attr("cy",function(t){return y(1-rankScale.invert(t.followers))}).attr("r",5).attr("fill",function(t,e){return d3.schemeCategory10[1]}),a.append("text").attr("x",function(t){return x(t.followers)}).attr("y",function(t){return 15+y(1-rankScale.invert(t.followers))}).html(function(e){return"<a href='https://github.com/"+t+"'>@"+e.login+"</a>"}).style("fill","rgb(42, 100, 150)").style("font-size","12px"))}d3.select("#rankLog").on("change",function(t){setYScale(y==yLog?yLinear:yLog)}),d3.select("#followersLog").on("change",function(t){setXScale(x==xLog?xLinear:xLog)}),addUser("torvalds",68615);